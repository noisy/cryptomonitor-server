var request = require("request");

function Anxhk() {
	this._apiQuery = function(method, market, callback) {
		var uri = "https://anx.hk/bccapi/" + market + "/" + method + ".json";
    	var options = {
    		uri: uri,
      		agent: false,
      		method: 'GET',
      		headers: {
        		"User-Agent": "Mozilla/4.0 (compatible; CoinedUp API node client)",
        		"Content-type": "application/x-www-form-urlencoded"
      		},
      		"rejectUnauthorized": false
		};

		request(options, function(err, res, body) {
			try {
    			var response = JSON.parse(body);
    			if(typeof callback == typeof Function)
    				callback(response);
    		} catch(e) {
    			console.log(e);
    		}
    	});
	}

	this.orderbook = function(market, callback) {
		this._apiQuery('orderbook', market, callback);
	}

	this.trades = function(market, callback) {
		this._apiQuery('trades', market, callback);
	}
}

module.exports = Anxhk;